### 协议三要素

源文件 -> 词法分析 -> 语法分析 -> 语义分析 -> 代码生成 -> 目标文件

1.  语法

    就是这一段内容要符合一定的规则和格式。例如，括号要成对，结束要使用分号等。

1.  语义

    就是这一段内容要代表某种意义。例如数字减去数字是有意义的，数字减去文本一般来说就没有意义

1.  顺序

    就是先干啥，后干啥。例如，可以先加上某个数值，然后再减去某个数值

只有通过网络协议，才能使一大片机器互相协作、共同完成一件事。

```text
HTTP/1.1 200 OK
Date: Tue, 27 Mar 2018 16:50:26 GMT
Content-Type: text/html;charset=UTF-8
Content-Language: zh-CN

<!DOCTYPE html>
<html>
<head>
<base href="https://pages.kaola.com/" />
<meta charset="utf-8"/> <title> 网易考拉 3 周年主会场 </title>
```

状态，然后是首部，然后是内容。

### http 协议

|                  |        |
| ---------------- | ------ |
| DNS、HTTP、HTTPS | 应用层 |
| TCP、UDP         | 传输层 |
| IP               | 网络层 |
| ARP              | 链路层 |
| 网络跳线         | 物理层 |

浏览器 -> DNS 查找(获得 ip) -> 打包请求(HTTP,HTTPS) -> 传输层 (TCP) -> 网络层(IP) -> 链路层(ARP 获得 MAC 地址) 发给网关-> 网关通过路由表 (OSPF,BGP) -> 目标服务器 -> 核对 MAC 地址 -> 核对 IP -> TCP 回应 -> 端口进程(回复包)

传输层有两种协议，一种是无连接的协议 UDP，一种是面向连接的协议 TCP。对于支付来讲，往往使用 TCP 协议。所谓的面向连接就是，TCP 会保证这个包能够到达目的地。如果不能到达，就会重新发送，直至到达。

### 问题

1.  当网络包到达一个路由器的时候，可以通过路由表得到下一个路由器的 IP 地址，直接通过 IP 地址找就可以了，为什么还要通过本地的 MAC 地址呢？

    局域网内 IP 地址是动态分配的，假如我是 192.168.2.100，如果我下线了，可能 IP 就分配给了另一台电脑。IP 和设备并不总是对应的，这对通信就产生了问题。

    ip 可以保证要发送的包在网络中传输，到达目标服务器所在的局域网的网关，但是到了网关后，ip 就没有用了，因为局域网中的 ip 对应的机器是不确定的，可能今天对应 A 机器，明天对应 B 机器。所以在局域网中使用 ip 寻址是不严谨的，而 mac 地址是机器厂商给每个网卡配置的，这时就需要 mac 地址来唯一对应一台机器，这样网络包就可以准确的传输到需要的主机上了。并且这个过程所用的方法是 ARP 协议，即地址解析协议。
